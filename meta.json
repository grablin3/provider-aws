{
  "version": "3.0.0",

  "metadata": {
    "id": "provider-aws",
    "name": "AWS Infrastructure",
    "kind": "provider",
    "layers": ["ops", "cicd"],
    "type": "aws",
    "description": "Complete AWS infrastructure setup with Terraform, EC2 deployment, and multi-environment support",
    "version": "1.0.0",
    "author": "Genesis Team",
    "tags": ["aws", "terraform", "infrastructure", "ec2", "ops"]
  },

  "dependencies": {},

  "scaffoldConfigTemplate": [
    {
      "key": "awsRegion",
      "label": "AWS Region",
      "type": "select",
      "options": ["us-east-1", "us-west-1", "us-west-2", "eu-west-1", "ap-southeast-1"],
      "default": "us-west-1",
      "required": true,
      "description": "AWS region for deployment",
      "category": "infrastructure"
    },
    {
      "key": "awsAccountId",
      "label": "AWS Account ID",
      "type": "text",
      "default": "",
      "required": true,
      "description": "AWS account ID for resource deployment",
      "category": "infrastructure",
      "gitStoreKey": "AWS_ACCOUNT_ID"
    },
    {
      "key": "awsAdminId",
      "label": "AWS Admin Access Key ID",
      "type": "text",
      "default": "",
      "required": true,
      "description": "AWS admin IAM user access key ID for GitHub Actions",
      "category": "infrastructure",
      "gitStoreKey": "AWS_ADMIN_ID"
    },
    {
      "key": "awsAdminSecret",
      "label": "AWS Admin Secret Access Key",
      "type": "password",
      "default": "",
      "required": true,
      "description": "AWS admin IAM user secret access key for GitHub Actions",
      "category": "infrastructure",
      "gitStoreKey": "AWS_ADMIN_SECRET"
    },
    {
      "key": "instanceType",
      "label": "EC2 Instance Type",
      "type": "select",
      "options": ["t2.nano", "t2.micro", "t2.small", "t2.medium"],
      "default": "t2.micro",
      "required": true,
      "description": "EC2 instance type for application servers",
      "category": "infrastructure"
    },
    {
      "key": "databaseClass",
      "label": "RDS Instance Class",
      "type": "select",
      "options": ["db.t3.micro", "db.t3.small", "db.t3.medium"],
      "default": "db.t3.micro",
      "required": false,
      "description": "RDS database instance class",
      "category": "infrastructure"
    }
  ],

  "generation": {
    "files": {
      "remove": []
    },
    "layers": {
      "ops": {},
      "cicd": {
        "conditionalFiles": {
          "ifBackendLayerPresent": {
            "condition": "hasLayer('backend')",
            "files": [
              "cicd/.github/workflows/Code-320-server-ec2-pwd.yml.mustache"
            ]
          }
        }
      }
    },
    "postProcess": [
      {
        "type": "chmod",
        "pattern": "ops/**/*.sh",
        "mode": "+x"
      }
    ]
  },

  "environments": {
    "dev": {
      "instanceType": "t2.nano",
      "databaseClass": "db.t3.micro"
    },
    "staging": {
      "instanceType": "t2.micro",
      "databaseClass": "db.t3.micro"
    },
    "prod": {
      "instanceType": "t2.small",
      "databaseClass": "db.t3.small"
    }
  },

  "gitignore": [
    "# Terraform",
    ".terraform/",
    "*.tfstate",
    "*.tfstate.*",
    ".terraform.lock.hcl",
    "*.tfvars",
    "!**/terraform/environments/*.tfvars",
    "",
    "# AWS",
    "*.pem",
    "*.key",
    "",
    "# SSH Keys",
    "ssh-keys/*",
    "!ssh-keys/.gitkeep"
  ]
}

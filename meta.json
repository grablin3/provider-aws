{
  "version": "3.0.0",

  "metadata": {
    "id": "provider-aws",
    "name": "AWS Infrastructure",
    "kind": "provider",
    "layers": ["ops", "cicd"],
    "type": "aws",
    "providers": ["aws"],
    "description": "Complete AWS infrastructure setup with Terraform, EC2 deployment, and multi-environment support",
    "version": "1.0.0",
    "author": "Genesis Team",
    "tags": ["aws", "terraform", "infrastructure", "ec2", "ops"]
  },

  "dependencies": {},

  "scaffoldConfigTemplate": [
    {
      "key": "awsRegion",
      "label": "AWS Region",
      "type": "select",
      "options": ["us-east-1", "us-west-1", "us-west-2", "eu-west-1", "ap-southeast-1"],
      "optionNotes": {
        "us-east-1": { "notes": "N. Virginia - largest, most services" },
        "us-west-1": { "notes": "N. California - recommended" },
        "us-west-2": { "notes": "Oregon - good for west coast" },
        "eu-west-1": { "notes": "Ireland - Europe" },
        "ap-southeast-1": { "notes": "Singapore - Asia Pacific" }
      },
      "default": "us-west-1",
      "required": true,
      "description": "AWS region for deployment",
      "category": "infrastructure"
    },
    {
      "key": "awsAccountId",
      "label": "AWS Account ID",
      "type": "text",
      "default": "",
      "required": true,
      "description": "AWS account ID for resource deployment",
      "category": "infrastructure",
      "gitStoreKey": "AWS_ACCOUNT_ID"
    },
    {
      "key": "awsAdminId",
      "label": "AWS Admin Access Key ID",
      "type": "text",
      "default": "",
      "required": true,
      "description": "AWS admin IAM user access key ID for GitHub Actions",
      "category": "infrastructure",
      "gitStoreKey": "AWS_ADMIN_ID"
    },
    {
      "key": "awsAdminSecret",
      "label": "AWS Admin Secret Access Key",
      "type": "password",
      "default": "",
      "required": true,
      "secret": true,
      "description": "AWS admin IAM user secret access key for GitHub Actions",
      "category": "infrastructure",
      "gitStoreKey": "AWS_ADMIN_SECRET"
    },
    {
      "key": "instanceType",
      "label": "EC2 Instance Type",
      "type": "select",
      "options": ["t3.micro", "t3.small", "t3.medium", "t3.large"],
      "optionNotes": {
        "t3.micro": { "notes": "1 vCPU, 1GB RAM (~$8/month)" },
        "t3.small": { "notes": "2 vCPU, 2GB RAM (~$15/month) - recommended for POC" },
        "t3.medium": { "notes": "2 vCPU, 4GB RAM (~$30/month)" },
        "t3.large": { "notes": "2 vCPU, 8GB RAM (~$60/month)" }
      },
      "default": "t3.small",
      "required": true,
      "description": "EC2 instance type for application servers",
      "category": "infrastructure"
    },
    {
      "key": "databaseClass",
      "label": "RDS Instance Class",
      "type": "select",
      "options": ["db.t3.micro", "db.t3.small", "db.t3.medium"],
      "optionNotes": {
        "db.t3.micro": { "notes": "2 vCPU, 1GB RAM (~$15/month) - free tier eligible" },
        "db.t3.small": { "notes": "2 vCPU, 2GB RAM (~$30/month)" },
        "db.t3.medium": { "notes": "2 vCPU, 4GB RAM (~$60/month)" }
      },
      "default": "db.t3.micro",
      "required": false,
      "description": "RDS database instance class",
      "category": "infrastructure"
    },
    {
      "key": "useNatGateway",
      "label": "Use NAT Gateway",
      "type": "boolean",
      "default": false,
      "required": false,
      "description": "Enable NAT Gateway for EC2 private subnet placement. Adds ~$64/month per environment. Only needed for strict compliance (PCI-DSS, HIPAA) or fixed outbound IP requirements.",
      "category": "infrastructure"
    }
  ],

  "generation": {
    "files": {
      "remove": []
    },
    "layers": {
      "ops": {},
      "cicd": {}
    },
    "postProcess": [
      {
        "type": "chmod",
        "pattern": "ops/**/*.sh",
        "mode": "+x"
      }
    ]
  },

  "environments": {
    "dev": {
      "instanceType": "t3.small",
      "databaseClass": "db.t3.micro"
    },
    "staging": {
      "instanceType": "t3.small",
      "databaseClass": "db.t3.small"
    },
    "prod": {
      "instanceType": "t3.medium",
      "databaseClass": "db.t3.medium"
    }
  },

  "gitIgnore": {
    "ops": [
      "# Terraform",
      ".terraform/",
      "*.tfstate",
      "*.tfstate.*",
      ".terraform.lock.hcl",
      "*.tfvars",
      "!**/terraform/environments/*.tfvars",
      "",
      "# AWS",
      "*.pem",
      "*.key",
      "",
      "# SSH Keys",
      "ssh-keys/*",
      "!ssh-keys/.gitkeep"
    ]
  }
}
